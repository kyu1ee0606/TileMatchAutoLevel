# 레벨 에디터 UX 개선 계획

## 개선 우선순위

| 우선순위 | 개선 항목 | 예상 효과 | 난이도 | 상태 |
|----------|-----------|-----------|--------|------|
| P0 | 자동생성 → 에디터 연결 | 워크플로우 30% 단축 | 중 | ✅ 완료 |
| P0 | 시뮬레이션 결과 시각화 개선 | 의사결정 속도 2배 | 중 | ✅ 완료 |
| P1 | 기믹 언락 레벨 표시 | 실수 방지 | 하 | ✅ 완료 |
| P1 | 에디터 내 즉시 검증 | 반복 속도 50% 향상 | 상 | ✅ 완료 |
| P2 | 레이어 3D 프리뷰 | 공간 인지 개선 | 상 | ✅ 완료 |
| P2 | Undo/Redo 기능 | 실수 복구 | 중 | ✅ 완료 |

---

## P0: 자동생성 → 에디터 연결 (진행중)

### 문제점
- 자동 생성된 레벨을 에디터로 가져오는 경로가 불명확
- `GenerationResultCard` 컴포넌트가 정의되어 있지만 실제로 렌더링되지 않음
- 생성 결과와 에디터 간 컨텍스트 전환이 번거로움

### 해결 방안
1. GeneratorPanel에서 생성 완료 후 `GenerationResultCard` 표시
2. "에디터로 열기" 버튼 클릭 시 에디터 탭으로 자동 전환
3. "시뮬레이션" 버튼 클릭 시 시뮬레이션 탭으로 전환

### 구현 내용
```typescript
// GeneratorPanel에 추가할 내용
{lastGenerationResult && (
  <GenerationResultCard
    result={lastGenerationResult}
    onOpenInEditor={() => {
      setActiveTab('editor');
      addNotification('info', '에디터에서 레벨을 수정하세요');
    }}
    onRegenerate={() => handleGenerate(1)}
    onSimulate={() => setActiveTab('simulation')}
    isGenerating={isGenerating}
  />
)}
```

---

## P0: 시뮬레이션 결과 시각화 개선

### 문제점
- "검증 시작 버튼을 눌러..." 메시지가 모호함
- 클리어율만으로는 난이도 판단 어려움
- 실패 원인 설명 부재

### 해결 방안
1. 초기 상태 메시지 개선 (예상 시간, 설명 추가)
2. 목표 등급 대비 실제 결과 비교 표시
3. 난이도 조정 제안 추가

### 목표 UI
```
📊 난이도 분석 결과
┌────────────────────────────────────────┐
│ 목표: B등급 (40-60% 난이도)            │
│ 실제: A등급 (28% 난이도) ⚠️ 너무 쉬움  │
├────────────────────────────────────────┤
│ 🌱 초보자  ████████████ 95% 클리어     │
│ 🎮 캐주얼  █████████████ 98% 클리어    │
│ ...                                    │
├────────────────────────────────────────┤
│ 💡 제안: 타일 타입을 1개 추가하면      │
│         B등급에 근접합니다              │
└────────────────────────────────────────┘
```

---

## P1: 기믹 언락 레벨 표시

### 문제점
- 어떤 기믹이 언제 해금되는지 표시 없음
- 언락 전 기믹을 실수로 배치할 가능성

### 해결 방안
- 레벨 번호 입력 필드 추가
- 각 기믹에 언락 레벨 표시
- 미해금 기믹은 비활성화 또는 경고 표시

---

## P1: 에디터 내 즉시 검증

### 문제점
- 편집 → 시뮬레이션 탭 이동 → 검증 → 결과 확인 → 에디터 탭 이동 → 수정
- 반복 작업이 번거로움

### 해결 방안
- 에디터 화면에 미니 시뮬레이션 패널 추가
- 변경사항 자동 감지 + "재검증" 알림
- 결과를 사이드 패널에 실시간 표시

---

## 구현 파일 목록

### P0 관련 파일
- `frontend/src/components/GeneratorPanel/index.tsx` - 결과 카드 렌더링
- `frontend/src/stores/uiStore.ts` - 탭 전환 상태 관리
- `frontend/src/components/AutoPlayPanel/index.tsx` - 시각화 개선

### P1 관련 파일
- `frontend/src/components/GeneratorPanel/index.tsx` - 기믹 언락 표시
- `frontend/src/components/GridEditor/index.tsx` - 인라인 검증

---

## 진행 상태

### 2026-02-11
- [x] UX 분석 문서 작성
- [x] P0: 자동생성 → 에디터 연결 구현
  - GeneratorPanel에 GenerationResultCard 렌더링 추가
  - "에디터로 열기" 버튼 → 에디터 탭 자동 전환
  - "시뮬레이션" 버튼 → 시뮬레이션 탭 전환
- [x] P0: 시뮬레이션 결과 시각화 개선
  - 초기 상태 메시지 개선 (예상 시간, 봇 설명 추가)
  - 로딩 상태에 봇 아이콘 애니메이션 추가
  - 목표 등급 vs 실제 등급 비교 표시 추가
- [x] TypeScript 빌드 검증 통과
- [x] 서버 동작 확인 완료
- [x] P1: 기믹 언락 레벨 표시 구현
  - 현재 레벨 번호 입력 필드 추가 (1~1500, ±10 버튼)
  - 각 기믹에 언락 레벨 뱃지 표시 (🔒 Lv.N / ✨ Lv.N / Lv.N)
  - 미해금 기믹 비활성화 (반투명 + 클릭 불가)
  - 최근 해금 기믹 하이라이트 (녹색 테두리)
- [x] P1: 에디터 내 즉시 검증 구현
  - DifficultyPanel에 AutoPlayPanel 통합 (이미 존재)
  - levelVersion 추적으로 레벨 변경 감지
  - 레벨 수정 후 "재검증 필요" 알림 표시
  - 재검증 버튼으로 빠른 재분석 가능
- [x] P2: 레이어 3D 프리뷰 구현
  - LayerStackPreview 컴포넌트 신규 생성
  - 각 레이어별 타일 밀도 시각화 (프로그레스 바)
  - 기믹 포함 레이어 표시 (⚡ 아이콘, 주황색 바)
  - 레이어 선택 시 해당 레이어로 자동 이동
  - 편집 중인 레이어 위 상위 레이어 개수 표시
  - GridEditor 우측 사이드바에 통합
- [x] P2: Undo/Redo 기능 구현
  - levelStore에 히스토리 스택 추가 (최대 50개)
  - setTile, removeTile, clearLayer, fillLayer에 히스토리 저장
  - undo/redo 함수 구현
  - Ctrl+Z (실행 취소), Ctrl+Y/Ctrl+Shift+Z (다시 실행) 단축키
  - 에디터 상단에 Undo/Redo 버튼 추가
  - 버튼 비활성화 상태 표시 (canUndo/canRedo)
